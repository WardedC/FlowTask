/* === BOARD STYLES === */
:host {
  display: block;
  /* ğŸš€ Mejorar rendering de texto */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ====================================
   ğŸš€ HIGH PERFORMANCE DRAG & DROP
   60FPS - DESKTOP & MOBILE
   ==================================== */

/* === DRAG PREVIEW === */
/* 
  ğŸ¯ SOLUCIÃ“N AL BUG DE POSICIONAMIENTO:
  
  PROBLEMA: El preview aparece en la esquina superior izquierda
  
  CAUSA: transform con !important previene que Angular CDK modifique
  el transform dinÃ¡micamente para seguir el cursor del mouse
  
  SOLUCIÃ“N: 
  1. NO usar !important en transform (dejar que CDK lo maneje)
  2. Usar position: fixed con top: 0 y left: 0 como base
  3. CDK calcularÃ¡ y aplicarÃ¡ translate(x, y) automÃ¡ticamente
*/
.cdk-drag-preview {
  /* âœ¨ CRÃTICO 1: Position fixed en origen (0,0) */
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  
  /* âœ¨ CRÃTICO 2: Z-index muy alto para visibilidad */
  z-index: 10000 !important;
  
  /* âœ¨ CRÃTICO 3: Transform SIN !important - CDK necesita modificarlo */
  /* Angular CDK aplicarÃ¡ translate(x, y) aquÃ­ dinÃ¡micamente */
  will-change: transform;
  transform: translate3d(0, 0, 0);
  
  /* âœ¨ CRÃTICO 4: Pointer events NONE para detecciÃ³n correcta */
  pointer-events: none !important;
  
  /* âœ¨ Box-sizing correcto */
  box-sizing: border-box !important;
  
  /* âœ¨ Prevenir selecciÃ³n de texto */
  user-select: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  
  /* âœ¨ Prevenir drag nativo del navegador */
  -webkit-user-drag: none !important;
  
  /* âœ¨ Touch optimizations para mÃ³viles */
  touch-action: none !important;
  -webkit-tap-highlight-color: transparent !important;
  
  /* âœ¨ Antialiasing para movimiento suave */
  -webkit-font-smoothing: subpixel-antialiased;
  backface-visibility: hidden;
  perspective: 1000px;
  
  /* âœ¨ Ancho REAL de las tarjetas - MÃ¡s fiel al original */
  /* Matching con el ancho de las columnas del grid */
  width: 350px;
  min-width: 320px;
  max-width: 380px;
  
  /* âœ¨ Sombra pronunciada para destacar durante drag */
  box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.3), 
              0 8px 16px -4px rgba(0, 0, 0, 0.2);
  
  /* âœ¨ Opacidad para feedback visual */
  opacity: 0.98;
  
  /* âœ¨ Cursor visual durante drag */
  cursor: grabbing !important;
  
  /* âš ï¸ NO usar animation que modifique transform - interfiere con CDK */
  /* âš ï¸ NO usar backdrop-filter - mata performance */
  /* âš ï¸ NO usar transition en transform - CDK lo maneja */
  /* âš ï¸ NO usar margin que desplace el preview */
}

/* Estilo para el contenido interno del preview personalizado */
.drag-preview {
  /* Mantener diseÃ±o idÃ©ntico a la tarjeta original */
  /* Los estilos de Tailwind del HTML se encargan del resto */
  position: relative;
  
  /* Asegurar que el contenido no se desborde */
  overflow: hidden;
  
  /* Forzar ancho completo para que use todo el espacio del preview */
  width: 100%;
  box-sizing: border-box;
}

/* Dark mode shadow for preview - MÃ¡s pronunciada */
:host-context(.dark) .cdk-drag-preview {
  box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.6), 
              0 8px 16px -4px rgba(0, 0, 0, 0.4);
}

/* === DRAG ELEMENT (Original durante drag) === */
.cdk-drag {
  /* ğŸ¯ AceleraciÃ³n GPU - CRÃTICO para fluidez */
  will-change: transform;
  transform: translate3d(0, 0, 0);
  
  /* ğŸ¯ Cursor grab */
  cursor: grab;
  
  /* ğŸ¯ NO selecciÃ³n */
  user-select: none;
  -webkit-user-select: none;
  
  /* ğŸ¯ Touch optimizations */
  touch-action: none;
  -webkit-tap-highlight-color: transparent;
  
  /* ğŸ¯ TransiciÃ³n ULTRA SUAVE - Easing natural */
  /* Solo aplica cuando NO estÃ¡ siendo arrastrado */
  transition: transform 200ms cubic-bezier(0.25, 0.1, 0.25, 1);
  
  /* ğŸ¯ Antialiasing para movimiento suave */
  -webkit-font-smoothing: subpixel-antialiased;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  
  /* ğŸ¯ OptimizaciÃ³n de repaint */
  contain: layout style paint;
}

.cdk-drag:active {
  cursor: grabbing;
  /* Desactivar transition durante drag activo - CDK maneja el movimiento */
  transition: none;
}

/* === PLACEHOLDER === */
.cdk-drag-placeholder,
.drag-placeholder {
  /* ğŸ¯ AceleraciÃ³n GPU */
  will-change: transform, opacity;
  transform: translate3d(0, 0, 0);
  
  /* ğŸ¯ Mantener dimensiones */
  min-height: 100px;
  border-radius: 0.75rem;
  
  /* ğŸ¯ NO usar box-shadow pesado */
  opacity: 0.6;
  
  /* ğŸ¯ TransiciÃ³n suave de opacidad con easing */
  transition: opacity 200ms cubic-bezier(0.2, 0, 0, 1);
}

/* === DROP LIST === */
.cdk-drop-list,
.drop-zone {
  /* ğŸ¯ Contexto de posiciÃ³n */
  position: relative !important;
  
  /* ğŸ¯ AceleraciÃ³n GPU solo cuando necesario */
  will-change: auto;
  transform: translate3d(0, 0, 0);
  
  /* ğŸ¯ Aislamiento de layer para mejor performance */
  isolation: isolate;
  
  /* ğŸ¨ TransiciÃ³n suave para hover effects */
  transition: background-color 200ms ease;
  
  /* ğŸ¨ Fondo limpio sin borde - estilo workspace */
  border: none;
}

/* Estado hover del drop zone - sutil feedback */
.drop-zone:hover {
  background-color: rgba(59, 130, 246, 0.02);
}

:host-context(.dark) .drop-zone:hover {
  background-color: rgba(59, 130, 246, 0.05);
}

/* === ANIMACIÃ“N DE DRAG === */
.cdk-drag-animating {
  /* ğŸ¯ TransiciÃ³n ULTRA fluida de retorno con easing natural */
  /* Bezier curve optimizada para movimiento suave y natural */
  transition: transform 350ms cubic-bezier(0.25, 0.8, 0.25, 1) !important;
  will-change: transform !important;
  transform: translate3d(0, 0, 0);
}

/* === LISTA DURANTE DRAG === */
.cdk-drop-list-dragging .card-item:not(.cdk-drag-placeholder) {
  /* ğŸ¯ TransiciÃ³n ULTRA suave para reordenamiento */
  /* Easing optimizado para fluidez mÃ¡xima */
  transition: transform 200ms cubic-bezier(0.25, 0.46, 0.45, 0.94);
  
  /* ğŸ¯ AceleraciÃ³n GPU */
  will-change: transform;
  transform: translate3d(0, 0, 0);
  
  /* ğŸ¯ OptimizaciÃ³n de repaint */
  contain: layout style paint;
}

/* === ZONA RECEPTORA === */
.cdk-drop-list-receiving {
  /* ğŸ¯ Feedback visual SUTIL estilo workspace */
  background-color: rgba(0, 117, 162, 0.05) !important;
  box-shadow: inset 0 0 0 2px rgba(0, 117, 162, 0.2);
  
  /* ğŸ¯ TransiciÃ³n suave con easing natural */
  transition: background-color 200ms cubic-bezier(0.2, 0, 0, 1), 
              box-shadow 200ms cubic-bezier(0.2, 0, 0, 1);
}

:host-context(.dark) .cdk-drop-list-receiving {
  background-color: rgba(59, 130, 246, 0.1) !important;
  box-shadow: inset 0 0 0 2px rgba(59, 130, 246, 0.3);
}

/* ====================================
   ğŸš€ OPTIMIZATION: Simplificar durante drag
   ==================================== */

/* Cuando el body tiene clase 'is-dragging', optimizar renderizado */
:host-context(body.is-dragging) .card-item:not(.cdk-drag-preview) {
  /* Reducir sombras en tarjetas no arrastradas para mejor performance */
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  /* Forzar aceleraciÃ³n GPU */
  will-change: transform;
  transform: translate3d(0, 0, 0);
}

:host-context(body.is-dragging) .backdrop-blur-sm {
  /* Desactivar blur durante drag - muy costoso para performance */
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
}

/* Optimizar animaciones durante drag activo */
:host-context(body.is-dragging) * {
  /* Prevenir animaciones costosas durante drag */
  animation-play-state: paused !important;
}

/* === ANIMATIONS === */

/* Grip icon pulse - SOLO en hover, no durante drag */
.group:hover .fa-grip-vertical:not(.cdk-drag-preview *) {
  animation: grip-pulse 0.6s ease-in-out infinite;
}

@keyframes grip-pulse {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 1; }
}

/* Card entrance animation - Optimizada */
@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateZ(0) translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateZ(0) translateY(0);
  }
}

/* ğŸš€ IMPORTANTE: NO aplicar animaciÃ³n durante drag */
.card-item:not(.cdk-drag-animating) {
  animation: slideIn 0.3s ease-out;
  /* AceleraciÃ³n GPU */
  will-change: auto;
}

/* Button shine effect */
button:hover {
  position: relative;
  overflow: hidden;
}

button:hover::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  animation: shine 0.6s;
}

@keyframes shine {
  to { left: 100%; }
}

/* === UTILITIES === */

/* Card item base - OptimizaciÃ³n de rendimiento */
.card-item {
  /* ğŸ¯ AceleraciÃ³n GPU desde el inicio */
  will-change: transform;
  transform: translate3d(0, 0, 0);
  
  /* ğŸ¯ OptimizaciÃ³n de repaint */
  contain: layout style paint;
  
  /* ğŸ¯ Antialiasing para textos suaves */
  -webkit-font-smoothing: subpixel-antialiased;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* Glass effect */
.backdrop-blur-sm {
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

/* Custom scrollbar */
.space-y-3::-webkit-scrollbar {
  width: 6px;
}

.space-y-3::-webkit-scrollbar-track {
  background: transparent;
}

.space-y-3::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 3px;
}

:host-context(.dark) .space-y-3::-webkit-scrollbar-thumb {
  background: #4b5563;
}

.space-y-3::-webkit-scrollbar-thumb:hover {
  background: #94a3b8;
}

:host-context(.dark) .space-y-3::-webkit-scrollbar-thumb:hover {
  background: #6b7280;
}

/* Dark mode shadow improvements */
:host-context(.dark) .shadow-sm {
  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3);
}

:host-context(.dark) .shadow-lg {
  box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5);
}
